# Auth Fix - February 1, 2026 12:17 PM PST

## Issues Found

### 1. CORS Configuration
**Problem:** `pokernight.famylin.com` was not in the allowed origins list
**Fix:** Added to `poker-backend/src/server.ts`

### 2. Frontend Environment Variable
**Problem:** `VITE_API_URL` had a literal `\n` character at the end
- Was: `https://poker-night-app-production-985f.up.railway.app/api\n`  
- Should be: `https://poker-night-app-production-985f.up.railway.app/api`

**Fix:** Removed and re-added the environment variable in Vercel

### 3. OAuth Redirect URI
**Problem:** OAuth callback was using wrong base URL
**Fix:** Set `RAILWAY_PUBLIC_DOMAIN=poker-night-app-production-985f.up.railway.app` on Railway

## Changes Made

### Backend (poker-backend)
```diff
const allowedOrigins = [
  process.env.FRONTEND_URL || 'http://localhost:5173',
  'https://poker-night-app.vercel.app',
+ 'https://poker-player-manager.vercel.app',
+ 'https://pokernight.famylin.com',
  'https://edwinpokernight.com',
  'https://www.edwinpokernight.com',
  'http://localhost:5173',
  'http://localhost:5175'
];
```

### Environment Variables Updated

**Railway (Backend):**
- ✅ `FRONTEND_URL=https://pokernight.famylin.com`
- ✅ `RAILWAY_PUBLIC_DOMAIN=poker-night-app-production-985f.up.railway.app`

**Vercel (Frontend):**
- ✅ `VITE_API_URL=https://poker-night-app-production-985f.up.railway.app/api` (fixed)

## Test Results

✅ Frontend loads: https://pokernight.famylin.com  
✅ "Sign in with Google" button triggers OAuth flow  
✅ Redirects to Google authentication  
✅ OAuth callback configured correctly  

## Deployment Status

- Backend: Redeploying on Railway (automatic)
- Frontend: Deployed on Vercel ✅

## Next Test

After Railway finishes redeploying (~30 seconds), test complete login flow:
1. Visit https://pokernight.famylin.com
2. Click "Sign in with Google"
3. Complete Google auth
4. Should redirect back and be logged in

---

**Fixed by:** Ollie (AI Assistant)  
**Date:** February 1, 2026 12:17 PM PST
